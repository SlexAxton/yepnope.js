
 
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html lang="en" class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" ><!--<![endif]-->
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Yepnope.js Test Suite</title>

<link rel="stylesheet" href="qunit.css" type="text/css" media="screen">
<script type="text/javascript" src="../yepnope.js"></script>
<!-- load the supported plugins so they can be tested as well. Will break them out when it makes sense -->
<script type="text/javascript" src="../prefixes/yepnope.ie-prefix.js"></script>
<script type="text/javascript" src="../prefixes/yepnope.preload.js"></script>

<!-- load the plugin under test -->
<script type="text/javascript" src="../plugins/yepnope.ready.js"></script>

<script type="text/javascript" src="qunit.js"></script>
<script type="text/javascript" src="qunit.testtimer.js"></script>
<script type="text/javascript" src="jquery-1.6.4.min.js"></script>
<script>! window.jQuery && document.write('<script src="jquery.js"><\/script>');</script>
</head>
<body>
<h1 id="qunit-header">yepnope.ready.js plugin Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
        <div id="qunit-fixture">test markup</div>
        <div id="cssTests"></div>
</body>

<script type="text/javascript">


window.testResults = {};


module("integration with yepnope");


asyncTest("single string load", 3, function(){
	var test = asyncTest.start();
	
	yepnope('js/testJs1.js');
	ok(	! window.testResults.testJs1, "not loaded before queueing");
	yepnope.ready('js/testJs1.js', function(){
		ok(window.testResults.testJs1 == 'executed', "on ready, is loaded");
		test.continue();
	});
	ok(	! window.testResults.testJs1, "not loaded after queueing");
	
});

asyncTest("simple array load", 5, function(){
	var test = asyncTest.start(1);
	
	yepnope(['js/testJs2.js', 'js/testJs3.js', 'js/testJs10.js']);
	ok(	! window.testResults.testJs2 && ! window.testResults.testJs3, "not loaded before queueing");
	yepnope.ready('js/testJs2.js,js/testJs3.js', function(){
		ok(window.testResults.testJs2 == 'executed', "on ready, js2 is loaded");
		ok(window.testResults.testJs3 == 'executed', "on ready, js3 is loaded");
		ok(! window.testResults.testJs9, "on ready, js10 is not loaded");
		test.continue();
	});
	ok(	! window.testResults.testJs2 && ! window.testResults.testJs3, "not loaded after queueing");
});

asyncTest("array load with complete", 9, function(){
	var test = asyncTest.start(2);
	
	var completeCalled = false;
	yepnope([{
		load: ['js/testJs4.js', 'js/testJs5.js'],
		complete: function(){
			completeCalled = true;
			ok(window.testResults.testJs4 == 'executed', "on complete, js4 is loaded");
			ok(window.testResults.testJs5 == 'executed', "on complete, js5 is loaded");
			test.continue();
		}
	}]);
	ok(	! window.testResults.testJs4 && ! window.testResults.testJs5, "not loaded before queueing");
	ok(	! window.testResults.testJs5 && ! window.testResults.testJs5, "not loaded before queueing");
	yepnope.ready('js/testJs4.js,js/testJs5.js', function(){
		ok(window.testResults.testJs4 == 'executed', "on ready, js4 is loaded");
		ok(window.testResults.testJs5 == 'executed', "on ready, js5 is loaded");
		ok(completeCalled, "complete should have been called first");
		test.continue();
	});
	ok(	! window.testResults.testJs4 && ! window.testResults.testJs5, "not loaded after queueing");
	ok(	! window.testResults.testJs5 && ! window.testResults.testJs5, "not loaded after queueing");

});

asyncTest("load by key", 4, function(){
	var test = asyncTest.start(2);
	
	var completeCalled = false;
	yepnope({
		load: {'scriptKey': 'js/testJs6.js'},
		complete: function(){
			completeCalled = true;
			test.continue();
		}
		});
	ok(	! window.testResults.testJs6, "not loaded before queueing");
	yepnope.ready('scriptKey', function(){
		ok(window.testResults.testJs6 == 'executed', "on ready, is loaded");
		ok(completeCalled, "on ready, complete already called");
		test.continue();
	});
	ok(	! window.testResults.testJs6, "not loaded after queueing");

});

asyncTest("load failed, reload by key", 6, function(){
	var test = asyncTest.start(3, 20000);
	
	var reload = false;
	var completeCalled = false;
	ok(	! window.testResults.testJs7, "not loaded before queueing");
	yepnope({
		load: {'scriptKey': 'js/testJsbroken.js'},
		callback: function(){
			reload = true;
			yepnope({
				load:{'scriptKey': 'js/testJs7.js'},
				complete: function(){
					completeCalled = true;
					ok(true, "complete called");
					test.continue();
				}
			});
			ok(true, "callback called");
			test.continue();
		}
		});
		
	yepnope.ready('scriptKey', function(){
		ok(window.testResults.testJs7 == 'executed', "on ready, is loaded");
		ok(reload, "on ready, reload already called");
		ok(completeCalled, "on ready, complete already called");
		test.continue();
	});
});

asyncTest("array load all", 4, function(){
	var test = asyncTest.start(1);
	
	yepnope(['js/testJs8.js', 'js/testJs9.js']);
	ok(	! window.testResults.testJs8 && ! window.testResults.testJs9, "not loaded before queueing");
	yepnope.ready(function(){
		ok(window.testResults.testJs8 == 'executed', "on ready, js8 is loaded");
		ok(window.testResults.testJs9 == 'executed', "on ready, js9 is loaded");
		test.continue();
	});
	ok(	! window.testResults.testJs8 && ! window.testResults.testJs9, "not loaded after queueing");

});






</script>
</html>
